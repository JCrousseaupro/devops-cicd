name: Test Devops

on:
  push:
    branches: [main]

jobs:
  build-and-push:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Build image
        run: docker build -t my-app:${{github.sha}} .

      - name : test-unitaires

        run: |
          echo "Lancement du test unitaire ..."
          docker run -d --name test-unitaires my-app:${{github.sha}}
          sleep 5
          docker exec -it test-unitaires nginx -t
          echo "Test unitaire terminÃ©"
          docker stop test-unitaires
